---
title: Impression Level Data
---

CAS.AI SDK enables you to access detailed information for each impression through the impressions callback APIs. 
The information includes, for example, which demand source served the ad, the expected or exact revenue associated with it. 
In addition, it contains granular details to allow you to analyze and, ultimately, optimize user acquisition strategies. 

### OnAdImpressionListener
A functional interface for listening to ad impression events.
```java  
import com.cleveradssolutions.sdk.OnAdImpressionListener;

final OnAdImpressionListener impressionListener = new OnAdImpressionListener(){  
    @Override  
    public void onAdImpression(@NonNull AdContentInfo ad) {  
        // Called when an ad impression occurs. 
    }  
};
```
Each ad format provides a `setOnImpressionListener` method on the ad object for registering a listener to receive `AdContentInfo` with impression details.  
```java
CASAppOpen appOpenAd;
appOpenAd.setOnImpressionListener(impressionListener);

CASInterstitial interstitialAd;
interstitialAd.setOnImpressionListener(impressionListener);

CASRewarded rewardedAd;
rewardedAd.setOnImpressionListener(impressionListener);

NativeAdContent nativeAd;
nativeAd.setOnImpressionListener(impressionListener);
```

### AdContentInfo
The `com.cleveradssolutions.sdk.AdContentInfo` data structure, which contains information about the loaded/displayed ad. 

Additionally to `OnAdImpressionListener`, each ad format has a `getContentInfo()` method that returns `AdContentInfo`, but the info may be `null` before the ad is loaded.
```java
AdContentInfo info = eachAd.getContentInfo();
```


| Name               | Type       | Description                                                                                                                                                             |
| ------------------ | ---------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `format`           | `AdFormat` | Gets the format of the ad that is shown. See new `AdFormat` enum.                                                                                                       |
| `sourceName`       | `String`   | Gets the display name of the mediated network that purchased the impression.                                                                                            |
| `sourceId`         | `Int`      | Gets the ID of the mediated network that purchased the impression. See new `AdSourceId` constants.                                                                      |
| `sourceUnitId`     | `String`   | Gets the Ad Unit ID from the mediated network that purchased the impression.                                                                                            |
| `creativeId`       | `String?`  | Gets the Creative ID associated with the ad, if available. May be null. You can use this ID to report creative issues to the Ad review team.                            |
| `revenue`          | `Double`   | Gets the revenue generated from the impression, in USD. The revenue value may be either estimated or exact, depending on the precision specified by `revenuePrecision`. |
| `revenuePrecision` | `Int`      | Gets the precision type of the revenue field. See new `AdRevenuePrecision` constants.                                                                                   |
| `impressionDepth`  | `Int`      | Gets the total number of impressions across all ad formats for the current user, across all sessions.                                                                   |
| `revenueTotal`     | `Double`   | Gets the accumulated value of user ad revenue in USD from all ad format impressions.                                                                                    |
### User ad summary 
CAS count the number of ad impressions and the total revenue of all formats at the time of a new impression. 
```java
int totalImpressions = impression.getImpressionDepth();
Double totalRevenue = impression.getRevenueTotal();
```
<Info>
Progress is saved between sessions until the user clears your app's data.
</Info>

## Automatic collect ad revenue
The CAS SDK have features to automatically collect ad revenue to Google Analytics and Tenjin Analytics. Contact your account manager for details of enabling automatic events.
#### Google Analytics
If you haven't already, make sure to complete the following tasks:
1. Set up your project and app as described in [Get Started with Analytics](https://firebase.google.com/docs/analytics/get-started).
2. Make sure that you've linked your Firebase project to a Google Analytics account.
3. Ensure that you've included in your app the CAS SDK 3.5.0+.

To measure ad revenue, CAS SDK log [`ad_impression` events](https://firebase.google.com/docs/reference/android/com/google/firebase/analytics/FirebaseAnalytics.Event#public-static-final-string-ad_impression) whenever your user sees an advertisement in your app. These events contain details such as the ad platform, source, currency, and value. Optionally, the alternative event name can be `CAS_Impression`.  

#### Tenjin
If you haven't already, make sure to complete the following tasks:
1. Set up your project and app as described in [Get Started with Analytics](https://docs.tenjin.com/docs/android-sdk#basic-integration).
2. Make sure that you've [initialize tenjin session](https://docs.tenjin.com/docs/android-sdk#app-initialization). Or provide `TENJIN_SDK_KEY` with CAS SDK initialization to allow CAS initialize Tenjin SDK automatically. 
   `builder.withMediationExtras("tenjin_key", TENJIN_SDK_KEY)`
3. Ensure that you've included in your app the CAS SDK 3.7.2+.

## Custom collect ad revenue
The following code shows an implementation example for log `AD_IMPRESSION` event to Google Analytics.
```java
@Override  
public void onAdImpression(@NonNull AdContentInfo ad) {  
    Bundle params = new Bundle();  
    params.putString(FirebaseAnalytics.Param.AD_PLATFORM, "CAS");  
    params.putString(FirebaseAnalytics.Param.AD_FORMAT, ad.getFormat().toString());  
    params.putString(FirebaseAnalytics.Param.AD_SOURCE, ad.getSourceName());  
    params.putString(FirebaseAnalytics.Param.AD_UNIT_NAME, ad.getSourceUnitId());  
    params.putDouble(FirebaseAnalytics.Param.VALUE, ad.getRevenue());  
    // All CAS revenue is sent in USD  
    params.putString(FirebaseAnalytics.Param.CURRENCY, "USD");  
  
    FirebaseAnalytics.getInstance(this)  
            .logEvent(FirebaseAnalytics.Event.AD_IMPRESSION, params);  
}
```